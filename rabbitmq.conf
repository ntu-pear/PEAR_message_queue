# Memory management
vm_memory_high_watermark.relative = 0.6
# Disk space management
disk_free_limit.relative = 1.0
# Heartbeat
heartbeat = 60
# TCP settings
tcp_listen_options.backlog = 128
tcp_listen_options.nodelay = true
# Default user permissions
default_user_tags.administrator = true
# Management plugin
management.tcp.port = 15672

# AUTO-LOAD DEFINITIONS ON STARTUP - This is CRITICAL!
management.load_definitions = /etc/rabbitmq/definitions.json

# Clustering
cluster_name = pear-rabbitmq-staging-cluster
loopback_users.guest = false
listeners.tcp.default = 5672

# Commented out for local development
# Kubernetes peer discovery
# cluster_formation.peer_discovery_backend = rabbit_peer_discovery_k8s
# cluster_formation.k8s.host = kubernetes.default.svc.cluster.local
# cluster_formation.k8s.address_type = hostname
# cluster_formation.k8s.service_name = rabbitmq-headless-stg
# cluster_formation.node_cleanup.only_log_warning = true
# cluster_formation.node_cleanup.interval = 60
# cluster_partition_handling = autoheal

# Quorum queue settings
default_queue_type = quorum
quorum_queue.initial_cluster_size = 3
quorum_queue.commands_soft_limit = 100

# Logging
log.console = true
log.console.level = info
log.file = /var/log/rabbitmq/rabbitmq.log
log.file.level = info
log.file.rotation.size = 10485760

# Performance tuning
channel_max = 2047
heartbeat = 60
frame_max = 131072